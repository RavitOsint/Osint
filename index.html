<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>砖转 住专 - </title>
    <style>
        body { background: #0a0a0a; color: #00ff41; font-family: 'Courier New', monospace; text-align: center; padding: 50px; }
        .box { border: 2px solid #00ff41; padding: 30px; display: inline-block; min-width: 300px; }
        input { background: black; color: #00ff41; border: 1px solid #00ff41; padding: 10px; margin: 10px; }
        .error { color: #ff4141; font-weight: bold; }
        #timer { font-size: 2em; color: #ff4141; }
    </style>
</head>
<body>
    <div id="game" class="box">
        <h2 id="catTitle">注 拽专...</h2>
        <p id="qText"> 专...</p>
        <input id="userAns" placeholder="住 转砖">
        <button id="submitBtn" onclick="check()">砖</button>
        <p id="msg"></p>
        <div id="timer"></div>
    </div>

    <script>
        let questions = [];
        let currentIndex = 0;
        const DB_URL = "拽__转_-URL_砖/questions.json";
        const SETTINGS_URL = "拽__转_-URL_砖/settings.json";

        async function init() {
            const settings = await fetch(SETTINGS_URL).then(r => r.json());
            const allQ = await fetch(DB_URL).then(r => r.json());
            
            // 住 砖转 驻 拽专 砖专 专
            questions = Object.values(allQ).filter(q => q.category === settings.activeCategory);
            document.getElementById('catTitle').innerText = "拽专: " + settings.activeCategory;
            showQuestion();
        }

        function showQuestion() {
            if (currentIndex < questions.length) {
                document.getElementById('qText').innerText = questions[currentIndex].text;
                document.getElementById('msg').innerText = `砖 ${currentIndex + 1} 转 ${questions.length}`;
            } else {
                document.getElementById('game').innerHTML = "<h1> 砖 砖!</h1>";
            }
        }

        function check() {
            const val = document.getElementById('userAns').value;
            if (val === questions[currentIndex].answer) {
                currentIndex++;
                document.getElementById('userAns').value = "";
                showQuestion();
            } else {
                penalty();
            }
        }

        function penalty() {
            let timeLeft = 10;
            document.getElementById('submitBtn').disabled = true;
            document.getElementById('msg').innerText = "转砖 砖! 注专转 注...";
            
            const interval = setInterval(() => {
                document.getElementById('timer').innerText = timeLeft;
                timeLeft--;
                if (timeLeft < 0) {
                    clearInterval(interval);
                    document.getElementById('timer').innerText = "";
                    document.getElementById('submitBtn').disabled = false;
                    document.getElementById('msg').innerText = "";
                }
            }, 1000);
        }

        init();
    </script>
</body>
</html>
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>CyberQuest Admin - × ×™×”×•×œ ××ª×§×“×</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root { --sidebar-bg: #1e293b; --main-bg: #f8fafc; --accent: #38bdf8; --text-main: #0f172a; }
        body { font-family: 'Assistant', sans-serif; margin: 0; background-color: var(--main-bg); display: flex; min-height: 100vh; }
        #loginArea { position: fixed; inset: 0; background: var(--sidebar-bg); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-card { background: white; padding: 40px; border-radius: 15px; text-align: center; width: 300px; }
        #adminContent { width: 100%; display: none; }
        .sidebar { width: 260px; background: var(--sidebar-bg); color: white; padding: 20px; }
        .main-panel { flex: 1; padding: 40px; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 20px; }
        input, select { width: 100%; padding: 10px; margin: 8px 0; border: 1px solid #e2e8f0; border-radius: 8px; box-sizing: border-box; }
        button { background: var(--accent); color: var(--sidebar-bg); border: none; padding: 10px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; margin-top: 5px; }
        table { width: 100%; border-collapse: collapse; }
        th, td { text-align: right; padding: 10px; border-bottom: 1px solid #e2e8f0; }
        .delete-btn { background: #ef4444; color: white; width: auto; padding: 3px 8px; font-size: 0.8rem; }
        .cat-tag { display: inline-block; background: #e2e8f0; padding: 2px 8px; border-radius: 4px; margin: 2px; font-size: 0.8rem; }
    </style>
</head>
<body>

<div id="loginArea">
    <div class="login-card">
        <h2>×›× ×™×¡×ª ×× ×”×œ×ª</h2>
        <input type="password" id="adminPass" placeholder="×¡×™×¡××”">
        <button onclick="login()">×›× ×™×¡×”</button>
    </div>
</div>

<div id="adminContent">
    <div style="display: flex; width: 100%;">
        <div class="sidebar">
            <h2>× ×™×”×•×œ ×¡×™×™×‘×¨</h2>
            <div class="card" style="background: rgba(255,255,255,0.1); color: white;">
                <h4>ğŸ“ × ×™×”×•×œ ×§×˜×’×•×¨×™×•×ª</h4>
                <input id="newCatName" placeholder="×©× ×§×˜×’×•×¨×™×” ×—×“×©×”" style="background: white;">
                <button onclick="addCategory()" style="background: white;">×”×•×¡×£ ×§×˜×’×•×¨×™×”</button>
                <div id="catListSidebar" style="margin-top: 15px;"></div>
            </div>
        </div>

        <div class="main-panel">
            <h1>×œ×•×— ×‘×§×¨×”</h1>

            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
                <div class="card">
                    <h2>â• ×”×•×¡×¤×ª ×©××œ×”</h2>
                    <select id="qCatSelect"><option>×˜×•×¢×Ÿ ×§×˜×’×•×¨×™×•×ª...</option></select>
                    <select id="qType" onchange="document.getElementById('multOptions').style.display = (this.value=='multiple'?'block':'none')">
                        <option value="open">×©××œ×” ×¤×ª×•×—×” (Flag)</option>
                        <option value="multiple">×©××œ×” ×××¨×™×§××™×ª</option>
                    </select>
                    <input id="qText" placeholder="×ª×•×›×Ÿ ×”×©××œ×”">
                    <div id="multOptions" style="display:none">
                        <input id="opt1" placeholder="××•×¤×¦×™×” 1"><input id="opt2" placeholder="××•×¤×¦×™×” 2">
                        <input id="opt3" placeholder="××•×¤×¦×™×” 3"><input id="opt4" placeholder="××•×¤×¦×™×” 4">
                    </div>
                    <input id="qAns" placeholder="×”×ª×©×•×‘×” ×”× ×›×•× ×”">
                    <button onclick="addQuestion()">×©××•×¨ ×©××œ×”</button>
                </div>

                <div class="card">
                    <h2>ğŸ“º ×©×™×“×•×¨ ×—×™</h2>
                    <p>×‘×—×¨ ×§×˜×’×•×¨×™×” ×œ×”×¦×’×” ×œ×—× ×™×›×™×:</p>
                    <select id="activeCatSelect"></select>
                    <button onclick="setActive()" style="background: var(--sidebar-bg); color: white;">×”×¤×¢×œ ×©×™×“×•×¨</button>
                </div>
            </div>

            <div class="card">
                <h2>ğŸ“š ×××’×¨ ×©××œ×•×ª</h2>
                <table>
                    <thead><tr><th>×§×˜×’×•×¨×™×”</th><th>×©××œ×”</th><th>×ª×©×•×‘×”</th><th>×¤×¢×•×œ×”</th></tr></thead>
                    <tbody id="questionsTable"></tbody>
                </table>
            </div>
        </div>
    </div>
</div>

<script>
    const BASE_URL = "https://your-project-id.firebaseio.com/"; // ×—×•×‘×” ×œ×”×—×œ×™×£!
    const MASTER_PASSWORD = "zigi2026";

    function login() {
        if(document.getElementById('adminPass').value === MASTER_PASSWORD) {
            document.getElementById('loginArea').style.display = 'none';
            document.getElementById('adminContent').style.display = 'flex';
            loadData();
        } else { alert("×˜×¢×•×ª"); }
    }

    async function addCategory() {
        const name = document.getElementById('newCatName').value.trim();
        if(!name) return;
        await fetch(`${BASE_URL}categories.json`, { method: 'POST', body: JSON.stringify({name: name}) });
        document.getElementById('newCatName').value = "";
        loadData();
    }

    async function loadData() {
        // ×˜×¢×™× ×ª ×§×˜×’×•×¨×™×•×ª
        const cRes = await fetch(`${BASE_URL}categories.json`);
        const cData = await cRes.json();
        const qCatSelect = document.getElementById('qCatSelect');
        const activeCatSelect = document.getElementById('activeCatSelect');
        const sidebarCats = document.getElementById('catListSidebar');
        
        qCatSelect.innerHTML = ""; activeCatSelect.innerHTML = ""; sidebarCats.innerHTML = "";

        for (let id in cData) {
            let catName = cData[id].name;
            qCatSelect.innerHTML += `<option value="${catName}">${catName}</option>`;
            activeCatSelect.innerHTML += `<option value="${catName}">${catName}</option>`;
            sidebarCats.innerHTML += `<div class="cat-tag">${catName} <span style="cursor:pointer" onclick="deleteCat('${id}')">Ã—</span></div>`;
        }

        // ×˜×¢×™× ×ª ×©××œ×•×ª
        const qRes = await fetch(`${BASE_URL}questions.json`);
        const qData = await qRes.json();
        const tbody = document.getElementById('questionsTable');
        tbody.innerHTML = "";
        for (let id in qData) {
            tbody.innerHTML += `<tr>
                <td>${qData[id].category}</td>
                <td>${qData[id].text}</td>
                <td><code>${qData[id].answer}</code></td>
                <td><button class="delete-btn" onclick="deleteItem('questions/${id}')">××—×§</button></td>
            </tr>`;
        }
    }

    async function addQuestion() {
        const type = document.getElementById('qType').value;
        const data = {
            category: document.getElementById


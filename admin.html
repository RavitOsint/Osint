<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>ניהול מערכת סייבר - מאובטח</title>
    <style>
        body { font-family: 'Segoe UI', sans-serif; background: #f4f7f6; padding: 20px; text-align: right; }
        .card { background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.1); max-width: 600px; margin: 0 auto 20px; }
        input { width: 90%; padding: 10px; margin: 10px 0; border: 1px solid #ddd; border-radius: 5px; }
        button { background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 5px; cursor: pointer; font-weight: bold; }
        button.delete { background: #dc3545; padding: 5px 10px; font-size: 12px; }
        .q-item { background: #f9f9f9; padding: 10px; margin-top: 10px; border-right: 4px solid #007bff; display: flex; justify-content: space-between; align-items: center; }
        #adminContent { display: none; } /* מוסתר עד להזנת סיסמה */
    </style>
</head>
<body>

<div id="loginArea" class="card">
    <h2>כניסת מנהלת</h2>
    <input type="password" id="adminPass" placeholder="123">
    <button onclick="login()">כניסה</button>
</div>

<div id="adminContent">
    <div class="card">
        <h2>הוספת שאלה חדשה</h2>
        <input id="cat" placeholder="קטגוריה (למשל: תקשורת)">
        <input id="text" placeholder="השאלה לחניך">
        <input id="ans" placeholder="התשובה (Flag)">
        <button onclick="addQuestion()">פרסם שאלה</button>
    </div>

    <div class="card">
        <h2>ניהול שידור</h2>
        <p>איזו קטגוריה החניכים רואים עכשיו?</p>
        <input id="activeCat" placeholder="שם הקטגוריה להפעלה">
        <button onclick="setActive()">שנה קטגוריה פעילה</button>
    </div>

    <div id="list" class="card">
        <h2>שאלות קיימות בדאטה-בייס</h2>
        <div id="questionsContainer">טוען שאלות...</div>
    </div>
</div>

<script>
    // הגדרות Firebase - חובה להחליף ב-URL שלך!
    const BASE_URL = "https://osint-751d7-default-rtdb.europe-west1.firebasedatabase.app/"; 
    const MASTER_PASSWORD = "Zigi2025"; // שנו את הסיסמה כאן

    function login() {
        const pass = document.getElementById('adminPass').value;
        if (pass === MASTER_PASSWORD) {
            document.getElementById('loginArea').style.display = 'none';
            document.getElementById('adminContent').style.display = 'block';
            loadQuestions();
        } else {
            alert("סיסמה שגויה!");
        }
    }

    async function addQuestion() {
        const data = {
            category: document.getElementById('cat').value,
            text: document.getElementById('text').value,
            answer: document.getElementById('ans').value
        };
        await fetch(`${BASE_URL}questions.json`, { method: 'POST', body: JSON.stringify(data) });
        alert("השאלה נוספה בהצלחה!");
        loadQuestions();
    }

    async function setActive() {
        const cat = document.getElementById('activeCat').value;
        await fetch(`${BASE_URL}settings.json`, { method: 'PUT', body: JSON.stringify({ activeCategory: cat }) });
        alert("הקטגוריה עודכנה! החניכים יראו רק את שאלות: " + cat);
    }

    async function loadQuestions() {
        const res = await fetch(`${BASE_URL}questions.json`);
        const data = await res.json();
        const container = document.getElementById('questionsContainer');
        container.innerHTML = "";
        
        for (let id in data) {
            container.innerHTML += `
                <div class="q-item">
                    <span><b>[${data[id].category}]</b> ${data[id].text}</span>
                    <button class="delete" onclick="deleteQuestion('${id}')">מחק</button>
                </div>`;
        }
    }

    async function deleteQuestion(id) {
        if (confirm("בטוח שברצונך למחוק?")) {
            await fetch(`${BASE_URL}questions/${id}.json`, { method: 'DELETE' });
            loadQuestions();
        }
    }
</script>

</body>

</html>



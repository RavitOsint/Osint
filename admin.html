<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>CyberQuest Admin - × ×™×”×•×œ ××¢×¨×›×ª</title>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --sidebar-bg: #1e293b;
            --main-bg: #f8fafc;
            --accent: #38bdf8;
            --text-main: #0f172a;
        }

        body { font-family: 'Assistant', sans-serif; margin: 0; background-color: var(--main-bg); color: var(--text-main); display: flex; min-height: 100vh; }
        
        /* ××¡×š ×›× ×™×¡×” */
        #loginArea { position: fixed; inset: 0; background: var(--sidebar-bg); display: flex; align-items: center; justify-content: center; z-index: 1000; }
        .login-card { background: white; padding: 40px; border-radius: 15px; text-align: center; box-shadow: 0 10px 25px rgba(0,0,0,0.5); width: 300px; }
        
        /* ××‘× ×” Dashboard */
        #adminContent { display: none; width: 100%; display: flex; }
        .sidebar { width: 260px; background: var(--sidebar-bg); color: white; padding: 20px; display: flex; flex-direction: column; }
        .main-panel { flex: 1; padding: 40px; overflow-y: auto; }
        
        .card { background: white; padding: 25px; border-radius: 12px; box-shadow: 0 4px 6px rgba(0,0,0,0.05); margin-bottom: 25px; }
        
        h1, h2 { margin-top: 0; color: var(--sidebar-bg); }
        .sidebar h2 { color: var(--accent); font-size: 1.5rem; margin-bottom: 30px; }

        input, select { width: 100%; padding: 12px; margin: 10px 0; border: 1px solid #e2e8f0; border-radius: 8px; box-sizing: border-box; font-size: 1rem; }
        button { background: var(--accent); color: var(--sidebar-bg); border: none; padding: 12px 25px; border-radius: 8px; cursor: pointer; font-weight: bold; width: 100%; transition: 0.2s; }
        button:hover { opacity: 0.9; transform: translateY(-1px); }
        
        /* ×˜×‘×œ×ª ×©××œ×•×ª */
        table { width: 100%; border-collapse: collapse; margin-top: 20px; }
        th { background: #f1f5f9; text-align: right; padding: 12px; border-bottom: 2px solid #e2e8f0; }
        td { padding: 12px; border-bottom: 1px solid #e2e8f0; }
        .btn-delete { background: #ef4444; color: white; padding: 5px 10px; width: auto; font-size: 0.8rem; }

        .active-status { background: #dcfce7; color: #166534; padding: 5px 12px; border-radius: 20px; font-weight: bold; display: inline-block; }
    </style>
</head>
<body>

<div id="loginArea">
    <div class="login-card">
        <h2>CyberQuest Admin</h2>
        <input type="password" id="adminPass" placeholder="×¡×™×¡××ª × ×™×”×•×œ">
        <button onclick="login()">×›× ×™×¡×” ×œ××¢×¨×›×ª</button>
    </div>
</div>

<div id="adminContent" style="display: none;">
    <div class="sidebar">
        <h2>× ×™×”×•×œ ×¡×™×™×‘×¨</h2>
        <p>×©×œ×•×, ×”××“×¨×™×›×”</p>
        <hr style="width:100%; opacity: 0.1;">
        <p style="font-size: 0.9rem; color: #94a3b8;">×›××Ÿ ××ª ×©×•×œ×˜×ª ×‘×ª×•×›×Ÿ ×©××•×¦×’ ×œ×—× ×™×›×™× ×‘××ª×¨ ×”×¨××©×™.</p>
    </div>

    <div class="main-panel">
        <h1>×œ×•×— ×‘×§×¨×”</h1>
        
        <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 20px;">
            <div class="card">
                <h2>â• ×”×•×¡×¤×ª ×©××œ×”</h2>
                <input id="cat" placeholder="×§×˜×’×•×¨×™×” (×œ××©×œ: ×ª×§×©×•×¨×ª)">
                <input id="text" placeholder="×ª×•×›×Ÿ ×”×©××œ×”">
                <input id="ans" placeholder="×ª×©×•×‘×” × ×›×•× ×” (Flag)">
                <button onclick="addQuestion()">×¤×¨×¡× ×œ××¡×“ ×”× ×ª×•× ×™×</button>
            </div>

            <div class="card">
                <h2>ğŸ“º ×©×™×“×•×¨ ×—×™</h2>
                <p>×”×§×˜×’×•×¨×™×” ×©××•×¦×’×ª ×›×¨×’×¢ ×œ×—× ×™×›×™×:</p>
                <div class="active-status" id="currentActiveDisplay">×˜×•×¢×Ÿ...</div>
                <input id="activeCatInput" placeholder="×©× ×”×§×˜×’×•×¨×™×” ×œ×”×¤×¢×œ×”">
                <button onclick="setActive()" style="background: var(--sidebar-bg); color: white;">×¢×“×›×Ÿ ×©×™×“×•×¨</button>
            </div>
        </div>

        <div class="card">
            <h2>ğŸ“š ×××’×¨ ×©××œ×•×ª</h2>
            <table>
                <thead>
                    <tr>
                        <th>×§×˜×’×•×¨×™×”</th>
                        <th>×©××œ×”</th>
                        <th>×ª×©×•×‘×”</th>
                        <th>×¤×¢×•×œ×•×ª</th>
                    </tr>
                </thead>
                <tbody id="questionsTableBody">
                    </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    // ×”×’×“×¨×•×ª - ×—×•×‘×” ×œ×”×—×œ×™×£ ×‘-URL ×©×œ×š!
    const BASE_URL = "https://osint-751d7-default-rtdb.europe-west1.firebasedatabase.app/"; 
    const MASTER_PASSWORD = "zigi2026";

    function login() {
        if (document.getElementById('adminPass').value === MASTER_PASSWORD) {
            document.getElementById('loginArea').style.display = 'none';
            document.getElementById('adminContent').style.display = 'flex';
            loadData();
        } else { alert("×¡×™×¡××” ×©×’×•×™×”"); }
    }

    async function loadData() {
        // ×˜×¢×™× ×ª ×”×’×“×¨×•×ª (×§×˜×’×•×¨×™×” ×¤×¢×™×œ×”)
        const sRes = await fetch(`${BASE_URL}settings.json`);
        const settings = await sRes.json();
        document.getElementById('currentActiveDisplay').innerText = settings ? settings.activeCategory : "××™×Ÿ";

        // ×˜×¢×™× ×ª ×©××œ×•×ª
        const qRes = await fetch(`${BASE_URL}questions.json`);
        const data = await qRes.json();
        const tbody = document.getElementById('questionsTableBody');
        tbody.innerHTML = "";
        
        for (let id in data) {
            tbody.innerHTML += `
                <tr>
                    <td><b>${data[id].category}</b></td>
                    <td>${data[id].text}</td>
                    <td><code>${data[id].answer}</code></td>
                    <td><button class="btn-delete" onclick="deleteQuestion('${id}')">××—×§</button></td>
                </tr>`;
        }
    }

    async function addQuestion() {
        const data = {
            category: document.getElementById('cat').value,
            text: document.getElementById('text').value,
            answer: document.getElementById('ans').value
        };
        await fetch(`${BASE_URL}questions.json`, { method: 'POST', body: JSON.stringify(data) });
        loadData();
    }

    async function setActive() {
        const cat = document.getElementById('activeCatInput').value;
        await fetch(`${BASE_URL}settings.json`, { method: 'PUT', body: JSON.stringify({ activeCategory: cat }) });
        alert("×”×©×™×“×•×¨ ×¢×•×“×›×Ÿ!");
        loadData();
    }

    async function deleteQuestion(id) {
        if (confirm("×œ××—×•×§ ××ª ×”×©××œ×”?")) {
            await fetch(`${BASE_URL}questions/${id}.json`, { method: 'DELETE' });
            loadData();
        }
    }
</script>
</body>
</html>
